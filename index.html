<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MKTG1485 – Customer Journey Map (Week 4)</title>
<style>
  :root{
    --blue:#104a7a;          /* header rows: white text on blue */
    --grey:#f6f6f6;          /* lane labels: black text on grey */
    --line:#d5d5d5;
    --ink:#0b0c0c;
    --ok:#1b873f; --warn:#e3a008; --bad:#c92a2a;
    --radius:14px;
  }
  *{box-sizing:border-box}
  body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:#fff; color:var(--ink); line-height:1.42;}
  .wrap{max-width:1200px; margin:28px auto; padding:0 16px;}
  /* simple page header on white */
  .page-head{display:flex; align-items:end; justify-content:space-between; margin-bottom:10px;}
  .page-head h1{margin:0; font-size:1.4rem; color:#111;}
  .bar{display:flex; gap:8px; flex-wrap:wrap;}
  .btn{border:1px solid var(--line); background:#fff; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600;}
  .btn.primary{background:#ba372a; color:#fff; border-color:#ba372a;}
  .card{background:#fff; border:1px solid var(--line); border-radius:var(--radius); padding:16px; margin:14px 0;}
  .card h2{margin:0 0 10px; font-size:1.05rem; color:#111;}
  .grid-two{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
  .grid-three{display:grid; grid-template-columns:repeat(3,1fr); gap:12px;}
  label{font-size:12px; color:#333; display:block; margin-bottom:6px;}
  input[type="text"], input[type="date"], textarea{width:100%; padding:10px; border:1px solid var(--line); border-radius:10px; background:#fff; font-size:14px;}
  textarea{min-height:80px; resize:vertical;}
  .hint{font-size:12px; color:#666; margin-top:6px;}
  /* journey table */
  .journey{width:100%; border-collapse:separate; border-spacing:0; border:1px solid var(--line); border-radius:14px; overflow:hidden; background:#fff;}
  .journey thead th{background:var(--blue); color:#fff; padding:10px; font-size:13px; text-align:left;}
  .journey thead th.stage{min-width:160px;}
  .journey tbody th{width:200px; background:var(--grey); border-right:1px solid var(--line); padding:10px; font-size:13px; text-align:left; position:sticky; left:0; z-index:1; color:#111;}
  .journey td{border-left:1px solid var(--line); border-bottom:1px solid var(--line); padding:0; vertical-align:top;}
  .cell{padding:8px; min-height:90px; display:flex; flex-direction:column; gap:6px;}
  .cell textarea{min-height:90px; border:none; outline:none;}
  .stage-head{display:flex; align-items:center; gap:8px; justify-content:space-between; padding-right:8px;}
  .stage-name{width:100%; border:1px solid var(--line); border-radius:10px; padding:8px; background:#fff; font-weight:700;}
  .stage-actions button{border:none; background:transparent; color:#ba372a; cursor:pointer; font-weight:700;}
  .pill{display:inline-block; background:#fff; border:1px solid var(--line); padding:3px 8px; border-radius:999px; font-size:12px;}
  .emotion{display:flex; align-items:center; gap:8px; flex-wrap:wrap;}
  .emotion input[type="range"]{width:140px;}
  .legend{display:flex; gap:10px; font-size:12px; color:#444; margin-top:6px;}
  .legend .dot{width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:6px; vertical-align:middle;}
  .dot.good{background:var(--ok);} .dot.mid{background:var(--warn);} .dot.bad{background:var(--bad);}
  footer{margin:24px 0 36px; text-align:center; color:#666; font-size:12px;}
  @media print{
    .bar{display:none}
    a[href^="http"]::after{content:""}
    .journey thead th{background:#104a7a !important; -webkit-print-color-adjust:exact; print-color-adjust:exact;}
    .wrap{padding:0 10px;}
  }
</style>
</head>
<body>
  <div class="wrap" id="doc">
    <div class="page-head">
      <h1>Customer Journey Map – Week 4</h1>
      <div class="bar">
        <button class="btn" onclick="window.print()">Print</button>
        <button class="btn primary" onclick="downloadDoc('Customer_Journey_Map.doc')">Download as Word</button>
      </div>
    </div>

    <section class="card" aria-labelledby="meta-title">
      <h2 id="meta-title">Project details</h2>
      <div class="grid-three">
        <div><label for="course">Course</label><input id="course" type="text" value="MKTG1485 CX Strategy"></div>
        <div><label for="team">Team or student name</label><input id="team" type="text" placeholder="e.g., Team 7 — Journey Ninjas"></div>
        <div><label for="date">Date</label><input id="date" type="date"></div>
      </div>
      <div class="grid-two" style="margin-top:12px;">
        <div><label for="brand">Organisation or brand</label><input id="brand" type="text" placeholder="e.g., Darrell Lea"></div>
        <div><label for="persona">Target persona</label><input id="persona" type="text" placeholder="e.g., Health‑conscious parent"></div>
      </div>
      <p class="hint">Tip: use your Week 4 persona as the lens for every stage.</p>
    </section>

    <section class="card" aria-labelledby="map-title">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
        <h2 id="map-title">Journey map</h2>
        <div class="bar" role="toolbar" aria-label="Journey tools">
          <button class="btn" onclick="addStage()">Add stage</button>
          <button class="btn" onclick="resetStages()">Reset</button>
          <button class="btn primary" onclick="saveWork()">Save</button>
          <button class="btn" onclick="loadWork()">Load</button>
          <button class="btn" onclick="clearWork()">Clear saved</button>
        </div>
      </div>

      <table class="journey" id="journey" role="table" aria-label="Customer journey map">
        <thead>
          <tr id="headRow"><th class="stage">Lanes</th></tr>
          <tr id="stageRow"><th class="stage" aria-hidden="true"></th></tr>
        </thead>
        <tbody id="body"></tbody>
      </table>

      <div class="legend" aria-hidden="true">
        <span><span class="dot bad"></span>Low emotion</span>
        <span><span class="dot mid"></span>Neutral</span>
        <span><span class="dot good"></span>High emotion</span>
      </div>
    </section>

    <section class="card" aria-labelledby="tips-title">
      <h2 id="tips-title">Marking cues</h2>
      <ul>
        <li>Link every claim to evidence. Add short sources in cells where relevant.</li>
        <li>Keep a single story across stages. Show how pain points become opportunities.</li>
        <li>Ensure opportunities align with Assessment 1 or the live brief.</li>
      </ul>
    </section>

    <footer>&copy; 2025 RMIT University · MKTG1485 CX Strategy</footer>
  </div>

<script>
  const defaultStages = ["Awareness","Consideration","Purchase","Onboarding","Use","Support","Loyalty"];
  const lanes = [
    { key:"goals",   label:"Customer goals" },
    { key:"actions", label:"Customer actions" },
    { key:"touch",   label:"Touchpoints & channels" },
    { key:"emotion", label:"Emotion score" },
    { key:"pain",    label:"Pain points" },
    { key:"opps",    label:"Opportunities" },
    { key:"metrics", label:"Success metrics" }
  ];
  let stages = [...defaultStages];

  function makeEl(tag, attrs={}, html=""){
    const el = document.createElement(tag);
    Object.entries(attrs).forEach(([k,v])=>{ if(k==="class") el.className=v; else if(k==="for") el.htmlFor=v; else el.setAttribute(k,v); });
    if(html) el.innerHTML = html; return el;
  }

  function buildTable(){
    const headRow = document.getElementById("headRow");
    const stageRow = document.getElementById("stageRow");
    const body = document.getElementById("body");
    headRow.innerHTML = '<th class="stage">Lanes</th>';
    stageRow.innerHTML = '<th class="stage" aria-hidden="true"></th>';
    body.innerHTML = "";

    stages.forEach((s, idx)=>{
      const th = makeEl("th",{}, "");
      const wrap = makeEl("div",{class:"stage-head"});
      const input = makeEl("input",{class:"stage-name","data-stage-idx":idx,type:"text",value:s,ariaLabel:`Stage name ${idx+1}`});
      input.addEventListener("input", e => { stages[idx] = e.target.value; });
      const actions = makeEl("div",{class:"stage-actions"});
      const del = makeEl("button",{title:"Remove stage","data-remove":idx},"Remove");
      del.addEventListener("click", ()=> removeStage(idx));
      actions.appendChild(del); wrap.appendChild(input); wrap.appendChild(actions); th.appendChild(wrap);
      headRow.appendChild(th);
      stageRow.appendChild(makeEl("th",{}, `<span class="pill">Stage ${idx+1}</span>`));
    });

    lanes.forEach(l => {
      const tr = makeEl("tr");
      tr.appendChild(makeEl("th",{}, l.label));
      stages.forEach((s, idx)=>{
        const td = makeEl("td");
        const cell = makeEl("div",{class:"cell"});
        if(l.key === "emotion"){
          const row = makeEl("div",{class:"emotion"});
          const range = makeEl("input",{type:"range", min:"0", max:"10", value:"5", "data-key":`${idx}-emotion`});
          const out = makeEl("span",{class:"pill"},"5 / 10");
          range.addEventListener("input", e => { out.textContent = `${e.target.value} / 10`; out.style.background = emotionColour(+e.target.value); });
          out.style.background = emotionColour(5);
          row.appendChild(range); row.appendChild(out); cell.appendChild(row);
          cell.appendChild(makeEl("textarea",{placeholder:"Why does the emotion rise or fall here?"}));
        } else {
          cell.appendChild(makeEl("textarea",{placeholder:placeholderFor(l.key)}));
        }
        td.appendChild(cell); tr.appendChild(td);
      });
      body.appendChild(tr);
    });
  }

  function placeholderFor(key){
    switch(key){
      case "goals": return "What is the customer trying to achieve at this stage?";
      case "actions": return "What do they do, say, search or decide?";
      case "touch": return "Key touchpoints and channels. Who or what do they interact with?";
      case "pain": return "Friction, blockers, anxieties. Evidence snippets.";
      case "opps": return "Quick wins and bigger fixes. Link to concept ideas.";
      case "metrics": return "How will you measure success for this stage?";
      default: return "Notes...";
    }
  }
  function emotionColour(v){ if(v<=3) return "rgba(201,42,42,.12)"; if(v<=7) return "rgba(227,160,8,.15)"; return "rgba(27,135,63,.18)"; }
  function addStage(){ stages.push("New stage"); buildTable(); }
  function removeStage(i){ if(stages.length<=1){ alert("At least one stage is required."); return; } stages.splice(i,1); buildTable(); }
  function resetStages(){ stages = [...defaultStages]; buildTable(); }

  function collect(){
    const data = { meta:{
        course:document.getElementById('course').value,
        team:document.getElementById('team').value,
        brand:document.getElementById('brand').value,
        persona:document.getElementById('persona').value,
        date:document.getElementById('date').value
      }, stages:[...stages], cells:{} };
    const body = document.getElementById('body');
    Array.from(body.querySelectorAll('tr')).forEach((row,rIdx)=>{
      Array.from(row.querySelectorAll('td')).forEach((td,cIdx)=>{
        const ta = td.querySelector('textarea'); data.cells[`${rIdx}-${cIdx}`] = ta ? ta.value : "";
      });
    });
    return data;
  }
  function apply(data){
    if(data.meta){
      document.getElementById('course').value = data.meta.course || "";
      document.getElementById('team').value   = data.meta.team   || "";
      document.getElementById('brand').value  = data.meta.brand  || "";
      document.getElementById('persona').value= data.meta.persona|| "";
      document.getElementById('date').value   = data.meta.date   || "";
    }
    if(Array.isArray(data.stages) && data.stages.length){ stages = data.stages; }
    buildTable();
    const body = document.getElementById('body');
    Array.from(body.querySelectorAll('tr')).forEach((row,rIdx)=>{
      Array.from(row.querySelectorAll('td')).forEach((td,cIdx)=>{
        const ta = td.querySelector('textarea'); const key = `${rIdx}-${cIdx}`;
        if(ta && data.cells && Object.prototype.hasOwnProperty.call(data.cells,key)){ ta.value = data.cells[key]; }
      });
    });
  }
  function saveWork(){ localStorage.setItem("cx_week4_journey", JSON.stringify(collect())); flash("Saved to your browser"); }
  function loadWork(){ const raw = localStorage.getItem("cx_week4_journey"); if(!raw){ flash("Nothing saved yet"); return; } try{ apply(JSON.parse(raw)); flash("Loaded from your browser"); }catch(e){ alert("Could not load saved data"); } }
  function clearWork(){ localStorage.removeItem("cx_week4_journey"); flash("Cleared saved copy"); }
  function flash(msg){ const n=document.createElement('div'); n.textContent=msg; Object.assign(n.style,{position:'fixed',bottom:'20px',left:'50%',transform:'translateX(-50%)',background:'#0b0c0c',color:'#fff',padding:'10px 14px',borderRadius:'999px',boxShadow:'0 6px 18px rgba(0,0,0,.18)',zIndex:'9999',fontWeight:'700'}); document.body.appendChild(n); setTimeout(()=>n.remove(),1500); }

  function downloadDoc(filename){
    const node = document.getElementById('doc').cloneNode(true);
    node.querySelectorAll('.bar').forEach(b=>b.remove());
    const html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>Export</title></head><body>${node.outerHTML}</body></html>`;
    const blob = new Blob(['\ufeff', html], {type:'application/msword'});
    const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download=filename; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  }

  buildTable();
</script>
</body>
</html>
