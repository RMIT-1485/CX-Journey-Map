<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MKTG1485 – Customer Journey Map</title>

<style>
  :root{
    --rmit-blue:#0d1b4c;
    --rmit-red:#c71f23;
    --rmit-grey:#f6f6f6;
    --ink:#1b1b1b;
    --line:#e6e6e6;
  }
  html,body{margin:0;padding:0;background:#fff;color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;line-height:1.4}
  .wrap{max-width:1200px;margin:26px auto;padding:0 16px}

  /* Top labels */
  .course-label{font-family:Arial, Helvetica, sans-serif;font-size:14px;color:#333;margin-bottom:6px}
  h1{font-size:22px;margin:0 0 12px;color:var(--rmit-blue)}

  /* Controls */
  .controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin:12px 0 18px}
  .btn{appearance:none;border:1px solid var(--rmit-blue);background:var(--rmit-blue);color:#fff;
       padding:8px 12px;border-radius:8px;font-size:13px;cursor:pointer}
  .btn.secondary{background:#fff;color:var(--rmit-blue)}
  .btn:disabled{opacity:.45;cursor:not-allowed}
  .hint{margin-left:auto;font-size:12px;color:#555}

  /* Project meta (no Course field) */
  .meta{display:grid;grid-template-columns:repeat(3,minmax(200px,1fr));gap:10px;background:var(--rmit-grey);
        border:1px solid var(--line);border-radius:10px;padding:12px}
  .meta label{font-size:12px;color:#333;display:block;margin-bottom:4px}
  .meta input{width:100%;border:1px solid var(--line);border-radius:8px;padding:8px 10px;font-size:13px}

  /* Journey map */
  .map-shell{border:1px solid var(--line);border-radius:12px;overflow:auto}
  .stage-head{display:grid;grid-template-columns:220px repeat(var(--cols),minmax(160px,1fr));border-bottom:1px solid var(--line);background:#fff}
  .stage-title{padding:6px;text-align:center;font-weight:600;color:var(--rmit-blue);font-size:12px;border-left:1px solid var(--line)}
  .stage-title:first-child{background:var(--rmit-grey);border-left:none;text-align:left;color:#333;font-weight:700}
  .row{display:grid;grid-template-columns:220px repeat(var(--cols),minmax(160px,1fr));border-top:1px solid var(--line)}
  .lane-name{background:var(--rmit-blue);color:#fff;padding:8px 10px;font-weight:700;font-size:13px}
  .lane-desc{display:block;color:#dfe6ff;font-size:10px;margin-top:6px;line-height:1.25}
  .cell{border-left:1px solid var(--line);background:#fff}
  .cell textarea{width:100%;height:84px;min-height:84px;resize:vertical;border:0;outline:none;padding:8px 10px;font-size:11.5px;line-height:1.35}
  .cell textarea::placeholder{color:#8a8a8a}

  /* Evidence tags */
  .tags{margin-top:16px;border:1px solid var(--line);border-radius:10px;padding:10px;background:#fff}
  .tags h2{margin:0 0 6px;color:var(--rmit-blue);font-size:16px}
  .tags .subtle{margin:0 0 8px;color:#666;font-size:12px}
  .tag-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
  .tag-grid input{width:100%;border:1px solid var(--line);border-radius:8px;padding:6px 8px;font-size:11.5px}

  footer{margin:24px 0 10px;color:#777;font-size:12px}
</style>
</head>
<body>
<div class="wrap">
  <div class="course-label">MKTG1485 Customer Experience Strategy</div>
  <h1>Customer Journey Map</h1>

  <!-- Project details (Course removed) -->
  <section class="meta" aria-label="Project details">
    <div><label>Team or student name</label><input id="team" placeholder="e.g. Team 7 — Journey Ninjas" /></div>
    <div><label>Date</label><input id="date" type="date" /></div>
    <div><label>Target persona</label><input id="persona" placeholder="e.g. Night‑shift nurse commuter" /></div>
  </section>

  <!-- Controls -->
  <div class="controls">
    <button id="addStage" class="btn">Add stage</button>
    <button id="removeStage" class="btn secondary">Remove last stage</button>
    <button id="exportDocx" class="btn">Export to Word</button>
    <span id="stageHint" class="hint">Stages: 5 / 10</span>
  </div>

  <!-- Journey Map -->
  <section id="map" class="map-shell" aria-label="Journey map"></section>

  <!-- Evidence Tags -->
  <section class="tags" aria-label="Evidence tags">
    <h2>Evidence tags</h2>
    <p class="subtle">Add up to 20 short tags to cite your sources. Suggested scheme: interviews <em>(INT‑01)</em>, surveys <em>(SUR‑17)</em>, desk research <em>(SEC‑03)</em>.</p>
    <div id="tagGrid" class="tag-grid"></div>
  </section>

  <footer>© 2025 RMIT University · MKTG1485 CX Strategy</footer>
</div>

<!-- DOCX export library -->
<script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.min.js"></script>

<script>
/* ===== Config ===== */
const MAX_STAGES = 10;
const MIN_STAGES = 5;

const lanes = [
  {key:'doing', name:'Doing',
   desc:'What is the customer doing during each stage of their journey? This can contain more than one action if needed.',
   ph:'List the key actions taken at this stage. What do they do, say, search or decide?'},
  {key:'thinking', name:'Thinking',
   desc:'What is the customer thinking at each stage of the journey?',
   ph:'Write short quotes or thoughts. What questions are on their mind?'},
  {key:'feeling', name:'Feeling',
   desc:'This often includes an emotional arc across stages. Briefly describe the emotion and why it rises or falls.',
   ph:'Describe the emotion in words. Why does it rise or fall here?'},
  {key:'needs', name:'Needs/Goals',
   desc:'What your customers are trying to accomplish at each stage, and how goals evolve.',
   ph:'State the goal or need at this stage. How does it change?'},
  {key:'touch', name:'Touch Points',
   desc:'Any encounter where customers and business engage. Examples: website, email, phone, in store.',
   ph:'List channels and contacts used at this stage (site, app, SMS, call centre, staff)…'},
  {key:'pains', name:'Pain Points',
   desc:'Hurdles or issues faced at this stage.',
   ph:'Name specific frictions, delays, gaps or confusions here…'},
  {key:'opps', name:'Insights/Opportunities',
   desc:'Insights that show how to optimise the experience; write them so they are testable.',
   ph:'Write a specific, testable improvement linked to evidence…'},
  {key:'truth', name:'Moments of Truth',
   desc:'High‑stakes interactions where impressions are formed.',
   ph:'Call out decisive moments that shape trust and satisfaction…'}
];

let stages = ['Stage 1','Stage 2','Stage 3','Stage 4','Stage 5'];

/* ===== DOM helpers ===== */
const map = document.getElementById('map');
const stageHint = document.getElementById('stageHint');
const addBtn = document.getElementById('addStage');
const removeBtn = document.getElementById('removeStage');

function renderMap(){
  map.style.setProperty('--cols', stages.length);
  stageHint.textContent = `Stages: ${stages.length} / ${MAX_STAGES}`;

  // Header
  const head = document.createElement('div');
  head.className = 'stage-head';
  const corner = document.createElement('div');
  corner.className = 'stage-title';
  corner.textContent = 'Lanes';
  head.appendChild(corner);

  stages.forEach((label, i)=>{
    const h = document.createElement('div');
    h.className = 'stage-title';
    h.contentEditable = true;
    h.spellcheck = false;
    h.textContent = label;
    h.addEventListener('input', e=>{
      stages[i] = e.currentTarget.textContent.trim() || `Stage ${i+1}`;
    });
    head.appendChild(h);
  });

  // Body
  const frag = document.createDocumentFragment();
  lanes.forEach(l => {
    const row = document.createElement('div');
    row.className = 'row';

    const lane = document.createElement('div');
    lane.className = 'lane-name';
    lane.innerHTML = `${l.name}<span class="lane-desc">${l.desc}</span>`;
    row.appendChild(lane);

    stages.forEach((_, col)=>{
      const cell = document.createElement('div');
      cell.className = 'cell';
      const ta = document.createElement('textarea');
      ta.placeholder = l.ph;
      ta.setAttribute('aria-label', `${l.name} – ${stages[col]}`);
      cell.appendChild(ta);
      row.appendChild(cell);
    });

    frag.appendChild(row);
  });

  map.innerHTML = '';
  map.appendChild(head);
  map.appendChild(frag);

  addBtn.disabled = stages.length >= MAX_STAGES;
  removeBtn.disabled = stages.length <= MIN_STAGES;
}

/* Evidence tags grid (5 per row) */
const tagGrid = document.getElementById('tagGrid');
function renderTags(){
  tagGrid.innerHTML = '';
  for(let i=1;i<=20;i++){
    const inp = document.createElement('input');
    inp.placeholder = `Tag ${i} (e.g. INT‑01)`;
    tagGrid.appendChild(inp);
  }
}

/* Controls */
addBtn.addEventListener('click', ()=>{
  if(stages.length >= MAX_STAGES) return;
  const n = stages.length + 1;
  stages.push(`Stage ${n}`);
  renderMap();
});
removeBtn.addEventListener('click', ()=>{
  if(stages.length <= MIN_STAGES) return;
  stages.pop();
  renderMap();
});

/* Export to Word */
document.getElementById('exportDocx').addEventListener('click', async ()=>{
  const { Document, Packer, Paragraph, Table, TableRow, TableCell, WidthType, HeadingLevel } = window.docx;

  const headerCells = [new TableCell({children:[new Paragraph({text:'Lanes',bold:true})]})];
  stages.forEach(s=>headerCells.push(new TableCell({children:[new Paragraph({text:s,bold:true})]})));

  const rows = [ new TableRow({children:headerCells}) ];

  // Collect map values
  const laneRows = map.querySelectorAll('.row');
  laneRows.forEach((row, i)=>{
    const label = lanes[i].name;
    const tds = Array.from(row.querySelectorAll('textarea'));
    const cells = [new TableCell({children:[new Paragraph({text:label,bold:true})]})];
    tds.forEach(ta => cells.push(new TableCell({children:[new Paragraph(ta.value || '')]})));
    rows.push(new TableRow({children:cells}));
  });

  // Evidence tags
  const tagValues = Array.from(tagGrid.querySelectorAll('input')).map(i=>i.value).filter(Boolean);

  const doc = new Document({
    sections:[{
      children:[
        new Paragraph({text:'Customer Journey Map', heading:HeadingLevel.TITLE}),
        new Paragraph({text:`Team/Student: ${document.getElementById('team').value || ''}`}),
        new Paragraph({text:`Date: ${document.getElementById('date').value || ''}`}),
        new Paragraph({text:`Target persona: ${document.getElementById('persona').value || ''}`}),
        new Paragraph({text:' '}),
        new Table({rows, width:{size:100, type:WidthType.PERCENTAGE}}),
        new Paragraph({text:' '}),
        new Paragraph({text:'Evidence tags', heading:HeadingLevel.HEADING_2}),
        new Paragraph({text: tagValues.length ? tagValues.join(' • ') : '—'})
      ]
    }]
  });

  const blob = await Packer.toBlob(doc);
  const name = `JourneyMap_${(document.getElementById('team').value||'team').replace(/\s+/g,'_')}.docx`;
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = name;
  a.click();
  URL.revokeObjectURL(a.href);
});

/* Init */
renderMap();
renderTags();
</script>
</body>
</html>
