<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MKTG1485 · Customer Journey Map Form</title>
<style>
  :root{
    --rmit-blue:#0d1b4c;
    --rmit-red:#ba372a;
    --rmit-grey:#f6f6f6;
    --ink:#222;
  }
  html,body{margin:0;padding:0;font-family:Inter,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--ink);background:#fff;}
  .wrap{max-width:1200px;margin:40px auto;padding:0 20px 60px;}
  h1,h2,h3{margin:0 0 10px 0;color:var(--rmit-blue);font-weight:700}
  h1{font-size:1.6rem}
  h2{font-size:1.2rem}
  small,h4{color:#444}
  .card{background:var(--rmit-grey);border-radius:12px;padding:16px;margin:18px 0}
  .row{display:flex;gap:14px;flex-wrap:wrap}
  .row > *{flex:1 1 260px}
  label{display:block;font-weight:600;margin:0 0 6px;color:var(--rmit-blue)}
  input[type="text"], input[type="date"], textarea, select{
    width:100%;box-sizing:border-box;border:1px solid #d8d8d8;border-radius:10px;padding:10px 12px;font-size:14px;background:#fff
  }
  textarea{min-height:96px;resize:vertical}
  .actions{display:flex;gap:10px;flex-wrap:wrap;margin:14px 0 0}
  .btn{
    border:1px solid var(--rmit-blue);background:#fff;color:var(--rmit-blue);
    padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer
  }
  .btn.primary{background:var(--rmit-red);border-color:var(--rmit-red);color:#fff}
  .btn:disabled{opacity:.5;cursor:not-allowed}
  .hint{font-size:.85rem;color:#555}
  /* Journey table */
  .table-wrap{overflow:auto;border:1px solid #e8e8e8;border-radius:12px}
  table{border-collapse:separate;border-spacing:0;width:100%;min-width:960px}
  thead th{position:sticky;top:0;background:#fff;border-bottom:2px solid #eaeaea}
  th, td{padding:10px;vertical-align:top}
  th:first-child, td:first-child{position:sticky;left:0;background:#fff;z-index:1}
  th:first-child{z-index:2}
  th.stage-head{min-width:180px;text-align:center}
  .row-head{
    background:var(--rmit-blue);color:#fff;border-radius:10px;padding:10px;text-align:center;width:180px;min-width:180px
  }
  .descriptor{display:block;font-size:.78rem;color:#eef1ff;margin-top:6px;font-weight:500}
  .cell textarea{min-height:110px}
  .feel-ctl{display:flex;align-items:center;gap:10px;margin-top:8px}
  .feel-ctl input[type=range]{width:160px}
  .feel-emoji{font-size:1.2rem}
  .stage-title{width:100%;border:1px solid #d8d8d8;border-radius:8px;padding:6px 8px;text-align:center;font-weight:600}
  .thin{font-weight:500;font-size:.9rem;color:#666}
  .tags-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px}
  .muted{color:#666;font-size:.95rem}
  .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;background:#f1f1f1;border:1px solid #ddd;border-radius:6px;padding:0 6px}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Customer Journey Map · Form</h1>
    <p class="muted">Complete each prompt. Use your Week 4 persona as the customer lens for every stage. When finished, select <span class="kbd">Export to Word</span>.</p>

    <div class="card">
      <h2>Project details</h2>
      <div class="row">
        <div>
          <label>Course</label>
          <input type="text" id="course" placeholder="e.g. MKTG1485 CX Strategy" />
        </div>
        <div>
          <label>Team or student name</label>
          <input type="text" id="team" placeholder="e.g. Team 7 — Journey Ninjas" />
        </div>
        <div>
          <label>Date</label>
          <input type="date" id="date" />
        </div>
      </div>
      <div class="row">
        <div>
          <label>Organisation or brand</label>
          <input type="text" id="brand" placeholder="e.g. TAC" />
        </div>
        <div>
          <label>Target persona</label>
          <input type="text" id="persona" placeholder="e.g. Health‑conscious parent" />
        </div>
      </div>
      <p class="hint">Hint: use your Week 4 persona as the customer lens for every stage.</p>
    </div>

    <div class="actions">
      <button class="btn" id="addStageBtn">Add stage</button>
      <button class="btn" id="removeStageBtn">Remove last stage</button>
      <button class="btn primary" id="exportWordBtn">Export to Word</button>
    </div>

    <h2 style="margin-top:24px">Journey map</h2>
    <div class="table-wrap" id="tableWrap">
      <table id="jmTable" aria-describedby="journey-map">
        <thead>
          <tr id="theadRow">
            <th style="width:200px"></th>
            <!-- Stage heads injected here -->
          </tr>
        </thead>
        <tbody id="tbody">
          <!-- Rows injected here -->
        </tbody>
      </table>
    </div>

    <div class="card">
      <h2>Evidence tags</h2>
      <p class="muted">Add up to 20 tags to reference your sources, for example interviews <span class="kbd">(INT‑01)</span>, surveys <span class="kbd">(SUR‑12)</span>, desk research <span class="kbd">(SEC‑03)</span>. Use these codes inside your cells.</p>
      <div class="tags-grid" id="tagsGrid"></div>
    </div>

    <p class="muted">This form intentionally excludes saving, loading and printing options. Students should export directly to Word and submit per the assessment instructions.</p>
  </div>

<script>
  // ---------- Model ----------
  const MAX_STAGES = 10;
  const START_STAGES = 5;

  const rowDefs = [
    { key:'doing',  title:'Doing',  desc:'What is the customer doing during each stage of their journey? This can contain more than one action if needed.', prompt:'List the key actions taken at this stage. What do they do, say, search or decide?' },
    { key:'thinking', title:'Thinking', desc:'What is the customer thinking at each stage of the journey?', prompt:'Write short quotes or thoughts. What questions are on their mind?' },
    { key:'feeling', title:'Feeling', desc:'This often includes an emotional arc across the stages. You may draw this elsewhere. Use the slider to score the emotion at this stage.', prompt:'Describe the emotion in words. Why does it rise or fall here?' },
    { key:'needs', title:'Needs/Goals', desc:'What the customer is trying to accomplish at this stage, and how goals evolve as the journey progresses.', prompt:'State the immediate goal. How will they know they have succeeded?' },
    { key:'touchpoints', title:'Touch Points', desc:'Encounters where customer and organisation engage to exchange information or services, for example website, email, phone, in‑store.', prompt:'List channels and actors. Who or what do they interact with?' },
    { key:'painpoints', title:'Pain Points', desc:'Hurdles or issues the customer faces at this stage should be mapped.', prompt:'Note specific frictions with evidence tags, for example (INT‑03).' },
    { key:'opps', title:'Insights/Opportunities', desc:'Insights that show how the experience can be improved. Opportunities must link to a pain point, handover or information gap.', prompt:'Write a specific, testable opportunity that targets the bottleneck.' },
    { key:'mot', title:'Moments of Truth', desc:'High‑stakes interactions where the customer forms a strong impression of the organisation.', prompt:'Define the decisive moment and the expected outcome.' }
  ];

  let stages = [];

  // ---------- DOM helpers ----------
  const el = (tag, props={}, children=[])=>{
    const node = document.createElement(tag);
    Object.entries(props).forEach(([k,v])=>{
      if(k==='class') node.className = v;
      else if(k==='html') node.innerHTML = v;
      else node.setAttribute(k,v);
    });
    children.forEach(c=>node.appendChild(c));
    return node;
  };

  // ---------- Build table ----------
  function buildTable(initial=false){
    const theadRow = document.getElementById('theadRow');
    const tbody = document.getElementById('tbody');
    theadRow.innerHTML = '<th></th>';
    stages.forEach((stg, idx)=>{
      const th = el('th', { class:'stage-head' });
      const inp = el('input', { type:'text', class:'stage-title', value: stg.title || `Stage ${idx+1}`, 'data-stage':idx, 'aria-label':`Stage ${idx+1} title` });
      th.appendChild(inp);
      theadRow.appendChild(th);
    });

    tbody.innerHTML = '';
    rowDefs.forEach(row=>{
      const tr = el('tr');
      const head = el('th');
      head.appendChild(el('div',{class:'row-head',html:`${row.title}<span class="descriptor">${row.desc}</span>`}));
      tr.appendChild(head);

      stages.forEach((stg, sIdx)=>{
        const td = el('td',{class:'cell'});
        // content
        if(row.key==='feeling'){
          const ta = el('textarea',{placeholder:row.prompt, 'data-key':`${row.key}-${sIdx}`});
          const ctl = el('div',{class:'feel-ctl'});
          const slider = el('input',{type:'range', min:'0', max:'10', value:stg.feel || 5, 'data-feel':sIdx});
          const emoji = el('span',{class:'feel-emoji',html:getEmoji(stg.feel || 5)});
          slider.addEventListener('input', e=>{
            const v = Number(e.target.value);
            stages[sIdx].feel = v;
            emoji.textContent = getEmoji(v);
          });
          ctl.appendChild(slider); ctl.appendChild(emoji);
          td.appendChild(ta); td.appendChild(ctl);
        } else {
          const ta = el('textarea',{placeholder:row.prompt, 'data-key':`${row.key}-${sIdx}`});
          td.appendChild(ta);
        }
        tr.appendChild(td);
      });

      tbody.appendChild(tr);
    });
  }

  function getEmoji(v){
    // 0..10 map
    if(v<=1) return '😫';
    if(v<=3) return '😟';
    if(v<=5) return '😐';
    if(v<=7) return '🙂';
    return '😄';
  }

  // ---------- Stage management ----------
  function addStage(){
    if(stages.length>=MAX_STAGES) return;
    stages.push({ title:`Stage ${stages.length+1}`, feel:5 });
    buildTable();
    syncButtons();
  }

  function removeStage(){
    if(stages.length<=1) return;
    stages.pop();
    buildTable();
    syncButtons();
  }

  function syncButtons(){
    document.getElementById('addStageBtn').disabled = stages.length>=MAX_STAGES;
    document.getElementById('removeStageBtn').disabled = stages.length<=1;
  }

  // ---------- Evidence tags ----------
  function buildTags(){
    const grid = document.getElementById('tagsGrid');
    grid.innerHTML = '';
    for(let i=1;i<=20;i++){
      const wrap = el('div');
      const lab = el('label',{for:`tag_${i}`});
      lab.textContent = `Tag ${String(i).padStart(2,'0')}`;
      const inp = el('input',{type:'text', id:`tag_${i}`, placeholder:`e.g. INT‑${String(i).padStart(2,'0')}`});
      wrap.appendChild(lab); wrap.appendChild(inp);
      grid.appendChild(wrap);
    }
  }

  // ---------- Export to Word ----------
  function exportToWord(){
    // collect stage titles
    const headInputs = Array.from(document.querySelectorAll('.stage-title'));
    headInputs.forEach((inp, idx)=>{ stages[idx].title = inp.value.trim() || `Stage ${idx+1}`; });

    // collect cell content
    const data = {};
    rowDefs.forEach(r=>{
      data[r.key] = stages.map((_, sIdx)=>{
        const ta = document.querySelector(`textarea[data-key="${r.key}-${sIdx}"]`);
        return ta ? ta.value.trim() : '';
      });
    });

    // evidence tags
    const tags = [];
    for(let i=1;i<=20;i++){
      const v = (document.getElementById(`tag_${i}`).value||'').trim();
      if(v) tags.push(v);
    }

    // build a simple Word-compatible HTML document
    const htmlParts = [];
    htmlParts.push(`<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset="utf-8"><title>Journey Map</title>
      <style>
        body{font-family:Arial,Helvetica,sans-serif;color:#111}
        h1{color:${getCSSVar('--rmit-blue')};font-size:18pt}
        h2{color:${getCSSVar('--rmit-blue')};font-size:14pt;margin:12pt 0 6pt}
        table{border-collapse:collapse;width:100%}
        th,td{border:1px solid #ddd;padding:6pt;vertical-align:top}
        th.rowhead{background:${getCSSVar('--rmit-blue')};color:#fff;width:160pt}
        thead th{background:#fafafa}
        .muted{color:#555}
      </style></head><body>`);
    htmlParts.push(`<h1>Customer Journey Map</h1>`);
    htmlParts.push(`<p class="muted"><b>Course:</b> ${esc(document.getElementById('course').value)} &nbsp; <b>Team/Student:</b> ${esc(document.getElementById('team').value)} &nbsp; <b>Date:</b> ${esc(document.getElementById('date').value)}<br>
    <b>Organisation:</b> ${esc(document.getElementById('brand').value)} &nbsp; <b>Target persona:</b> ${esc(document.getElementById('persona').value)}</p>`);

    // table
    htmlParts.push(`<table><thead><tr><th></th>`);
    stages.forEach(s=>htmlParts.push(`<th>${esc(s.title)}</th>`));
    htmlParts.push(`</tr></thead><tbody>`);
    rowDefs.forEach(r=>{
      htmlParts.push(`<tr><th class="rowhead">${esc(r.title)}<div style="font-size:9pt;color:#eef1ff;">${esc(r.desc)}</div></th>`);
      stages.forEach((s, idx)=>{
        let content = esc(data[r.key][idx] || '');
        if(r.key==='feeling'){
          const score = stages[idx].feel ?? 5;
          content = `<div>${content}</div><div class="muted">Emotion score: ${score} / 10</div>`;
        }
        htmlParts.push(`<td>${content}</td>`);
      });
      htmlParts.push(`</tr>`);
    });
    htmlParts.push(`</tbody></table>`);

    if(tags.length){
      htmlParts.push(`<h2>Evidence tags</h2><ul>`);
      tags.forEach(t=>htmlParts.push(`<li>${esc(t)}</li>`));
      htmlParts.push(`</ul>`);
    }

    htmlParts.push(`</body></html>`);
    const blob = new Blob([htmlParts.join('')], {type:'application/msword'});
    const a = document.createElement('a');
    const d = new Date();
    const stamp = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
    a.href = URL.createObjectURL(blob);
    a.download = `Journey-Map_${stamp}.doc`;
    a.click();
    URL.revokeObjectURL(a.href);
  }

  function esc(s){ return (s||'').replace(/[&<>]/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;' }[m])); }
  function getCSSVar(v){ return getComputedStyle(document.documentElement).getPropertyValue(v).trim() || '#0d1b4c'; }

  // ---------- Init ----------
  (function init(){
    for(let i=0;i<START_STAGES;i++) addStage();
    buildTags();
    document.getElementById('addStageBtn').addEventListener('click', addStage);
    document.getElementById('removeStageBtn').addEventListener('click', removeStage);
    document.getElementById('exportWordBtn').addEventListener('click', exportToWord);
  })();
</script>
</body>
</html>
