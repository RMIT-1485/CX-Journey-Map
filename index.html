<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MKTG1485 CX Strategy ‚Äî Customer Journey Map</title>

  <!-- RMIT palette -->
  <style>
    :root{
      --rmit-blue:#0d1b4c;
      --rmit-red:#c71f23;
      --rmit-grey:#f6f6f6;
      --ink:#1b1b1b;
      --line:#e6e6e6;
      --muted:#6b7280;
      --bg:#ffffff;
    }
    html,body{margin:0;padding:0;background:#fff;color:var(--ink);font-family:Arial,Helvetica,sans-serif;}
    .wrap{max-width:1280px;margin:24px auto;padding:0 16px 60px;}
    /* Top headings */
    .course-kicker{font-size:14px;color:var(--muted);letter-spacing:.2px;margin:0 0 8px;}
    h1{font-size:28px;margin:0 0 18px;color:var(--rmit-blue);font-weight:700;}
    /* Project details grid */
    .details{
      display:grid;gap:12px;
      grid-template-columns: repeat(3, minmax(220px,1fr));
      align-items:end;
      margin:6px 0 14px;
    }
    .field{display:flex;flex-direction:column;gap:6px}
    .field label{font-size:13px;color:var(--muted)}
    .field input{
      border:1px solid var(--line);border-radius:8px;background:#fff;
      padding:10px 12px;font-size:14px;outline:none;min-height:40px;
    }
    .field input:focus{border-color:var(--rmit-blue);box-shadow:0 0 0 2px rgba(13,27,76,.1)}
    /* Controls */
    .toolbar{display:flex;gap:10px;align-items:center;margin:8px 0 16px}
    .btn{
      background:var(--rmit-blue);color:#fff;border:none;border-radius:10px;
      padding:10px 14px;font-size:14px;cursor:pointer
    }
    .btn:disabled{opacity:.4;cursor:not-allowed}
    .btn.alt{background:#fff;border:1px solid var(--line);color:var(--ink)}
    .counter{margin-left:auto;font-size:13px;color:var(--muted)}
    /* Journey map table */
    .map{
      width:100%;border-collapse:separate;border-spacing:0;
      table-layout:fixed;border:1px solid var(--line);border-radius:12px;overflow:hidden
    }
    .map thead th{
      position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);
      padding:10px 8px;text-align:center;font-weight:700;color:var(--rmit-blue);
      font-size:14px;
    }
    .map th:first-child{width:230px;text-align:left}
    .lane{
      background:var(--rmit-blue);color:#fff;vertical-align:top;
      border-right:1px solid #0b153a;padding:10px 12px
    }
    .lane h4{margin:0 0 6px;font-size:15px}
    .lane p{margin:0;font-size:11px;line-height:1.5;opacity:.95}
    .cell{
      border-left:1px solid var(--line);border-bottom:1px solid var(--line);
      padding:6px;background:#fff;vertical-align:top;
    }
    .cell textarea{
      width:100%;height:110px;resize:vertical;border:1px solid var(--line);
      border-radius:8px;padding:8px 10px;font-size:13px;line-height:1.4;outline:none;background:#fff;
    }
    .cell textarea:focus{border-color:var(--rmit-blue);box-shadow:0 0 0 2px rgba(13,27,76,.08)}

    /* Feeling slider */
    .feel-wrap{display:flex;flex-direction:column;gap:6px}
    .feel-top{display:flex;align-items:center;gap:8px}
    .emoji{font-size:18px;line-height:1}
    .feel-range{flex:1;appearance:none;height:6px;background:var(--line);border-radius:6px;outline:none}
    .feel-range::-webkit-slider-thumb{
      -webkit-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;
      background:var(--rmit-red);cursor:pointer;border:0;box-shadow:0 0 0 2px rgba(199,31,35,.2);
    }
    .feel-range::-moz-range-thumb{
      width:16px;height:16px;border-radius:50%;background:var(--rmit-red);border:0;cursor:pointer;
    }
    .feel-note{width:100%;min-height:72px;border:1px solid var(--line);border-radius:8px;padding:6px 8px;font-size:12.5px;resize:vertical}
    .hint{font-size:11px;color:var(--muted)}
    /* Evidence tags */
    .evidence{
      margin:18px 0 8px;padding:12px;border:1px dashed var(--line);border-radius:10px;background:var(--bg)
    }
    .evidence h3{margin:0 0 6px;font-size:15px;color:var(--rmit-blue)}
    .evidence p{margin:0 0 8px;font-size:12px;color:var(--muted)}
    .tag-grid{
      display:grid;grid-template-columns:repeat(5,minmax(120px,1fr));gap:8px;
    }
    .tag-grid input{
      border:1px solid var(--line);border-radius:8px;padding:6px 8px;font-size:12px;min-height:34px;
    }
    /* Helpers */
    .footer-note{margin-top:22px;font-size:12px;color:var(--muted)}
    @media (max-width:980px){
      .details{grid-template-columns:1fr}
      .map th:first-child{width:200px}
      .cell textarea{height:120px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <p class="course-kicker">MKTG1485 Customer Experience Strategy</p>
    <h1>Customer Journey Map</h1>

    <!-- Project details (no Course field) -->
    <div class="details" id="details">
      <div class="field">
        <label for="team">Team or student name</label>
        <input id="team" placeholder="e.g. Team 7 ‚Äî Journey Ninjas" />
      </div>
      <div class="field">
        <label for="date">Date</label>
        <input id="date" type="date" />
      </div>
      <div class="field">
        <label for="persona">Target persona</label>
        <input id="persona" placeholder="e.g. Night‚Äëshift nurse commuter" />
      </div>
    </div>

    <div class="toolbar">
      <button class="btn" id="addStageBtn">Add stage</button>
      <button class="btn alt" id="removeStageBtn">Remove last stage</button>
      <button class="btn" id="exportBtn" title="Download a .doc file">Export to Word</button>
      <span class="counter" id="stageCounter">Stages: 5 / 10</span>
    </div>

    <!-- Journey map -->
    <table class="map" id="journeyTable" aria-label="Customer journey map"></table>

    <!-- Evidence tags (subtle) -->
    <section class="evidence">
      <h3>Evidence tags</h3>
      <p>Reference where each claim came from. Use a consistent format, for example interviews (INT‚Äë01), surveys (SUR‚Äë17), desk research (SEC‚Äë03). Up to 20 tags.</p>
      <div class="tag-grid" id="tagGrid"></div>
    </section>

    <p class="footer-note">Tip: map what actually happens, not what you assume. If a claim is not tagged, consider leaving it out.</p>
  </div>

  <script>
    // ---------- Config ----------
    const MAX_STAGES = 10;
    const DEFAULT_STAGES = 5;

    const laneMeta = [
      {
        key:'doing',
        label:'Doing',
        helper:'What is the customer doing during each stage of their journey? This can contain more than one action if needed.',
        placeholder:'List the key actions taken at this stage. What do they do, say, search or decide?'
      },
      {
        key:'thinking',
        label:'Thinking',
        helper:'What is the customer thinking at each stage of the journey?',
        placeholder:'Write short quotes or thoughts. What questions are on their mind?'
      },
      {
        key:'feeling',
        label:'Feeling',
        helper:'This often includes an emotional arc across stages. Use the slider to record intensity and add a short note if helpful.',
        placeholder:'Add a short note explaining why the emotion rises or falls (optional).',
        type:'feeling' // special rendering
      },
      {
        key:'needs',
        label:'Needs/Goals',
        helper:'What your customers are trying to accomplish at each stage, and how goals evolve.',
        placeholder:'What is the goal at this stage? What does ‚Äúsuccess‚Äù look like for the customer?'
      },
      {
        key:'touchpoints',
        label:'Touch Points',
        helper:'Any encounter where customers and the business engage. e.g. website, email, phone call, in‚Äëstore.',
        placeholder:'Key touchpoints and channels. Who or what do they interact with?'
      },
      {
        key:'painpoints',
        label:'Pain Points',
        helper:'Hurdles or issues the customer faces in this stage.',
        placeholder:'What slows them down or causes frustration? What breaks here?'
      },
      {
        key:'opps',
        label:'Insights/Opportunities',
        helper:'How the experience can be optimised. Turn evidence into specific, testable opportunities.',
        placeholder:'Write a specific, testable opportunity linked to a pain point or gap.'
      },
      {
        key:'moments',
        label:'Moments of Truth',
        helper:'Interactions where emotional energy and impressions are highest.',
        placeholder:'What must go right here to build trust? Define the outcome that matters most.'
      }
    ];

    // Emoji mapping for the Feeling slider (1‚Äì5)
    const EMOJI = {1:'üò´', 2:'üòü', 3:'üòê', 4:'üôÇ', 5:'üòÑ'};
    const EMOJI_TEXT = {1:'Very low',2:'Low',3:'Neutral',4:'High',5:'Very high'};

    // ---------- State ----------
    let stageCount = DEFAULT_STAGES;

    // ---------- Build Evidence Tags ----------
    (function buildTags(){
      const grid = document.getElementById('tagGrid');
      for(let i=1;i<=20;i++){
        const inp = document.createElement('input');
        inp.placeholder = `Tag ${i} e.g. INT‚Äë0${Math.min(i,9)}`;
        grid.appendChild(inp);
      }
    })();

    // ---------- Helpers ----------
    function makeFeelingCell(){
      const wrap = document.createElement('div');
      wrap.className = 'feel-wrap';

      const top = document.createElement('div');
      top.className = 'feel-top';

      const emoji = document.createElement('span');
      emoji.className = 'emoji';
      emoji.textContent = EMOJI[3];

      const range = document.createElement('input');
      range.type = 'range';
      range.min = '1';
      range.max = '5';
      range.value = '3';
      range.className = 'feel-range';
      range.setAttribute('aria-label','Emotion level (1 very low ‚Äì 5 very high)');

      const label = document.createElement('span');
      label.className = 'hint';
      label.textContent = EMOJI_TEXT[3];

      range.addEventListener('input', ()=>{
        const v = +range.value;
        emoji.textContent = EMOJI[v];
        label.textContent = EMOJI_TEXT[v];
      });

      top.appendChild(emoji);
      top.appendChild(range);
      top.appendChild(label);

      const note = document.createElement('textarea');
      note.className = 'feel-note';
      note.placeholder = 'Add a short note (optional)‚Ä¶';

      wrap.appendChild(top);
      wrap.appendChild(note);
      return wrap;
    }

    // ---------- Journey Table Rendering ----------
    const table = document.getElementById('journeyTable');
    function renderTable(){
      table.innerHTML = '';
      // Header
      const thead = document.createElement('thead');
      const hrow = document.createElement('tr');
      const th0 = document.createElement('th');
      th0.textContent = 'Lanes';
      hrow.appendChild(th0);
      for(let s=1;s<=stageCount;s++){
        const th = document.createElement('th');
        th.textContent = `Stage ${s}`;
        hrow.appendChild(th);
      }
      thead.appendChild(hrow);
      table.appendChild(thead);

      // Body
      const tbody = document.createElement('tbody');
      laneMeta.forEach(lane=>{
        const tr = document.createElement('tr');
        const laneCell = document.createElement('td');
        laneCell.className='lane';
        laneCell.innerHTML = `<h4>${lane.label}</h4><p>${lane.helper}</p>`;
        tr.appendChild(laneCell);

        for(let s=1;s<=stageCount;s++){
          const td = document.createElement('td');
          td.className='cell';

          if(lane.type === 'feeling'){
            td.appendChild(makeFeelingCell());
          }else{
            const ta = document.createElement('textarea');
            ta.placeholder = lane.placeholder;
            td.appendChild(ta);
          }
          tr.appendChild(td);
        }
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);

      // Counter + buttons
      document.getElementById('stageCounter').textContent = `Stages: ${stageCount} / ${MAX_STAGES}`;
      document.getElementById('addStageBtn').disabled = stageCount>=MAX_STAGES;
      document.getElementById('removeStageBtn').disabled = stageCount<=1;
    }

    // ---------- Actions ----------
    document.getElementById('addStageBtn').addEventListener('click',()=>{
      if(stageCount<MAX_STAGES){
        stageCount++;
        renderTable();
      }
    });

    document.getElementById('removeStageBtn').addEventListener('click',()=>{
      if(stageCount>1){
        stageCount--;
        renderTable();
      }
    });

    // Export to Word (.doc with HTML payload)
    document.getElementById('exportBtn').addEventListener('click', ()=>{
      const team = (document.getElementById('team').value||'').trim();
      const persona = (document.getElementById('persona').value||'').trim();
      const date = document.getElementById('date').value || '';

      // Clone the table and convert inputs to static content
      const clone = table.cloneNode(true);

      // Convert standard textareas
      clone.querySelectorAll('textarea').forEach(t=>{
        const v = t.value.trim();
        const content = v ? v : `<em style="color:#777;">${t.placeholder||'‚Äî'}</em>`;
        const div = document.createElement('div');
        div.style.minHeight='80px';
        div.innerHTML = content.replace(/\n/g,'<br>');
        t.parentElement.replaceChild(div,t);
      });

      // Convert feeling widgets
      clone.querySelectorAll('.feel-wrap').forEach(w=>{
        const v = +(w.querySelector('input[type="range"]')?.value || 3);
        const note = w.querySelector('textarea')?.value?.trim();
        const div = document.createElement('div');
        const emoji = EMOJI[v] || 'üòê';
        const label = EMOJI_TEXT[v] || 'Neutral';
        div.innerHTML = `<strong>${emoji} ${label}</strong>${note ? '<br>'+note.replace(/\n/g,'<br>') : ''}`;
        w.parentElement.replaceChild(div,w);
      });

      const evidence = Array.from(document.querySelectorAll('#tagGrid input'))
        .map(i=>i.value.trim()).filter(Boolean);

      const html =
`<!DOCTYPE html><html><head><meta charset="utf-8"><title>Journey Map</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;font-size:12px;color:#111;}
h1{font-size:18px;color:#0d1b4c;margin:0 0 8px;}
h2{font-size:14px;margin:14px 0 8px;color:#0d1b4c;}
table{border-collapse:collapse;width:100%;table-layout:fixed}
th,td{border:1px solid #ddd;padding:6px;vertical-align:top}
th:first-child{width:220px}
.lane h4{margin:0 0 4px;font-size:12px}
.lane p{margin:0;font-size:10px;color:#555}
.tag{display:inline-block;border:1px solid #ddd;border-radius:6px;padding:4px 6px;margin:2px;font-size:11px}
</style>
</head><body>
<h1>Customer Journey Map</h1>
<p><strong>Team:</strong> ${team || '‚Äî'}<br>
<strong>Date:</strong> ${date || '‚Äî'}<br>
<strong>Target persona:</strong> ${persona || '‚Äî'}</p>
${clone.outerHTML}
<h2>Evidence tags</h2>
<p>${evidence.length? evidence.map(t=>`<span class="tag">${t}</span>`).join(' ') : '<em>No tags provided.</em>'}</p>
</body></html>`;

      const blob = new Blob(['\ufeff', html], {type: 'application/msword;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      const safeTeam = team ? team.replace(/[^\w\-]+/g,'_') : 'journey';
      a.download = `${safeTeam}_journey_map.doc`;
      document.body.appendChild(a);
      a.click();
      URL.revokeObjectURL(url);
      a.remove();
    });

    // Initial render
    renderTable();
  </script>
</body>
</html>
